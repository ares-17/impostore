import{_ as C,u as y,I as l,c as n,o as r,j as a,J as i,n as k,e as d,G as b,H as x,b as T,t as U,g as S}from"./chunks/framework.DD1SAG0R.js";import{M as f,a as N,b as V,c as I,d as P,e as B}from"./chunks/theme.cGFIXAJ8.js";import{g as D}from"./chunks/gameCode.B_tBZGK0.js";const A={name:"MaterialUserEdit",components:{MaterialTextInput:N,MaterialButton:f},props:{modelValue:{type:String,default:""},index:{type:Number,required:!0},deletable:{type:Boolean,default:!0}},emits:["update:modelValue","add-user"],setup(){const{isDark:t}=y();return{isDark:t}},data(){return{nickname:this.modelValue}},watch:{modelValue(t){this.nickname=t}},methods:{handleNicknameChange(t){this.$emit("update:modelValue",t)},addUser(){this.nickname.trim()&&(this.$emit("add-user",this.nickname.trim()),this.nickname="")}}},G={class:"user-edit-content w-full"},O={class:"flex flex-grow sm:flex-row sm:items-end gap-3 w-full items-center"},j={class:"flex-grow sm:w-auto"},F={class:"mt-2 sm:mt-0 sm:ml-2 flex-shrink-0"};function J(t,e,u,m,s,o){const p=l("MaterialTextInput"),h=l("MaterialButton");return r(),n("div",{class:k(["material-user-edit",{"dark-mode":m.isDark}])},[a("div",G,[a("div",O,[a("div",j,[i(p,{class:"flex-grow",modelValue:s.nickname,"onUpdate:modelValue":[e[0]||(e[0]=g=>s.nickname=g),o.handleNicknameChange],label:`Giocatore ${u.index+1}`,placeholder:"Inserisci nickname"},null,8,["modelValue","label","onUpdate:modelValue"])]),a("div",F,[i(h,{icon:"PLUS","color-scheme":"PRIMARY",size:"small",disabled:!s.nickname.trim(),onClick:o.addUser,class:"add-button"},null,8,["disabled","onClick"])])])])],2)}const E=C(A,[["render",J],["__scopeId","data-v-6eeb63d9"]]),z={name:"CreatePartyPage",components:{MaterialUserAvatar:B,MaterialAddUser:E,MaterialNumberInput:P,MaterialTextButton:I,MaterialToast:V,MaterialButton:f},setup(){const{isDark:t}=y();return{isDark:t,joinParty:()=>{window.location.href=S("/join-party")}}},data(){return{avatars:[],newUser:"",impostorsCount:1,showSuccessToast:!1,toastMessage:"",toastType:"success",gameCode:null}},computed:{maxImpostors(){return Math.max(1,this.avatars.length-1)},isFormValid(){return this.avatars.length>=3&&this.impostorsCount>=1&&this.impostorsCount<this.avatars.length}},mounted(){this.loadFromStorage()},methods:{addNewUser(){this.newUser.trim()&&(this.avatars.push(this.newUser.trim()),this.newUser="",this.saveToStorage())},removeUser(t){this.avatars.splice(t,1),this.saveToStorage(),this.impostorsCount>=this.avatars.length&&(this.impostorsCount=Math.max(1,this.avatars.length-1))},async createParty(){if(this.isFormValid)try{const{code:t,config:e}=D(this.avatars,this.impostorsCount,`Partita del ${new Date().toLocaleDateString()}`);sessionStorage.setItem("currentParty",JSON.stringify(e)),sessionStorage.setItem("currentGameCode",JSON.stringify(t)),this.gameCode=t,this.toastMessage="Partita creata con successo!",this.toastType="success",this.showSuccessToast=!0}catch(t){this.toastMessage=`Errore: ${t.message}`,this.toastType="error",this.showSuccessToast=!0}},async copyGameCode(){try{await navigator.clipboard.writeText(this.gameCode),this.toastMessage="Codice copiato negli appunti!",this.toastType="success",this.showSuccessToast=!0}catch{this.toastMessage="Impossibile copiare il codice",this.toastType="error",this.showSuccessToast=!0}},saveToStorage(){sessionStorage.setItem("savedNicknames",JSON.stringify(this.avatars))},loadFromStorage(){try{const t=sessionStorage.getItem("savedNicknames");if(t){const e=JSON.parse(t);e.length>0&&(this.avatars=e)}}catch(t){console.error("Errore nel caricamento dei nicknames:",t)}}}},L={class:"page-container"},R={class:"avatars-grid"},Y={key:0,class:"add-user-section"},q={key:0},H={key:1,class:"create-button-section"},K={key:2,class:"game-code-section"},Q={class:"code-container"},W={class:"game-code"},X={class:"share-button-section",style:{"margin-top":"16px"}},Z={key:0,class:"join-party"};function $(t,e,u,m,s,o){const p=l("MaterialUserAvatar"),h=l("MaterialAddUser"),g=l("MaterialNumberInput"),_=l("MaterialTextButton"),M=l("MaterialButton"),w=l("MaterialToast");return r(),n("div",{class:k(["create-party-page",{"dark-mode":m.isDark}])},[a("div",L,[e[7]||(e[7]=a("h1",{class:"page-title"},"Crea Nuova Partita ðŸŽ‰",-1)),a("div",null,[e[3]||(e[3]=a("h2",{class:"section-title"},"Giocatori",-1)),a("div",R,[(r(!0),n(b,null,x(s.avatars,(c,v)=>(r(),T(p,{key:v,nickname:c,size:60,clickable:!0,deletable:!s.gameCode,onDelete:se=>o.removeUser(v)},null,8,["nickname","deletable","onDelete"]))),128))]),s.gameCode?d("",!0):(r(),n("div",Y,[i(h,{modelValue:s.newUser,"onUpdate:modelValue":e[0]||(e[0]=c=>s.newUser=c),index:s.avatars.length,deletable:!1,onAddUser:o.addNewUser},null,8,["modelValue","index","onAddUser"])]))]),s.gameCode?d("",!0):(r(),n("div",q,[e[4]||(e[4]=a("h2",{class:"section-title"},"Impostori",-1)),i(g,{modelValue:s.impostorsCount,"onUpdate:modelValue":e[1]||(e[1]=c=>s.impostorsCount=c),label:"Numero di impostori",placeholder:"Inserisci numero impostori",max:o.maxImpostors,min:1,step:1},null,8,["modelValue","max"])])),s.gameCode?d("",!0):(r(),n("div",H,[i(_,{text:"Crea Partita ðŸŽ®","color-scheme":"primary",disabled:!o.isFormValid,onClick:o.createParty},null,8,["disabled","onClick"])])),s.gameCode?(r(),n("div",K,[e[5]||(e[5]=a("h3",null,"Codice Partita",-1)),a("div",Q,[a("code",W,U(s.gameCode),1),i(M,{icon:"COPY","color-scheme":"SECONDARY",size:"small",onClick:o.copyGameCode},null,8,["onClick"])]),e[6]||(e[6]=a("p",{class:"hint"},"Condividi questo codice con i giocatori per farli unire alla partita",-1)),a("div",X,[i(_,{text:"Condividi Token","color-scheme":"primary",disabled:!s.gameCode,onClick:t.shareGameCode},null,8,["disabled","onClick"])])])):d("",!0)]),s.gameCode?(r(),n("div",Z,[i(_,{text:"Accedi al party ðŸŽ®","color-scheme":"primary",disabled:!o.isFormValid,onClick:m.joinParty},null,8,["disabled","onClick"])])):d("",!0),i(w,{show:s.showSuccessToast,"onUpdate:show":e[2]||(e[2]=c=>s.showSuccessToast=c),message:s.toastMessage,type:s.toastType},null,8,["show","message","type"])],2)}const ee=C(z,[["render",$],["__scopeId","data-v-61b838bf"]]),ie=JSON.parse('{"title":"","description":"","frontmatter":{"prev":false,"next":false},"headers":[],"relativePath":"create-party.md","filePath":"create-party.md"}'),te={name:"create-party.md"},ne=Object.assign(te,{setup(t){return(e,u)=>(r(),n("div",null,[i(ee)]))}});export{ie as __pageData,ne as default};
