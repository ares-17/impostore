import{_ as k,u as C,I as c,c as i,o as r,j as a,J as n,n as f,e as d,a as _,G as x,H as M,b as U,t as T,g as S}from"./chunks/framework.rmZCRNbh.js";import{M as w,a as V,b as I,c as N,d as P,e as B}from"./chunks/theme.D2LepF1f.js";import{g as D}from"./chunks/gameCode.B_tBZGK0.js";const A={name:"MaterialUserEdit",components:{MaterialTextInput:V,MaterialButton:w},props:{modelValue:{type:String,default:""},index:{type:Number,required:!0},deletable:{type:Boolean,default:!0}},emits:["update:modelValue","add-user"],setup(){const{isDark:t}=C();return{isDark:t}},data(){return{nickname:this.modelValue}},watch:{modelValue(t){this.nickname=t}},methods:{handleNicknameChange(t){this.$emit("update:modelValue",t)},addUser(){this.nickname.trim()&&(this.$emit("add-user",this.nickname.trim()),this.nickname="")}}},j={class:"user-edit-content w-full"},F={class:"flex flex-grow sm:flex-row sm:items-end gap-3 w-full items-center"},G={class:"flex-grow sm:w-auto"},J={class:"mt-2 sm:mt-0 sm:ml-2 flex-shrink-0"};function O(t,e,u,m,s,o){const p=c("MaterialTextInput"),h=c("MaterialButton");return r(),i("div",{class:f(["material-user-edit",{"dark-mode":m.isDark}])},[a("div",j,[a("div",F,[a("div",G,[n(p,{class:"flex-grow",modelValue:s.nickname,"onUpdate:modelValue":[e[0]||(e[0]=g=>s.nickname=g),o.handleNicknameChange],label:`Giocatore ${u.index+1}`,placeholder:"Inserisci nickname"},null,8,["modelValue","label","onUpdate:modelValue"])]),a("div",J,[n(h,{icon:"PLUS","color-scheme":"PRIMARY",size:"small",disabled:!s.nickname.trim(),onClick:o.addUser,class:"add-button"},null,8,["disabled","onClick"])])])])],2)}const q=k(A,[["render",O],["__scopeId","data-v-6eeb63d9"]]),z={name:"CreatePartyPage",components:{MaterialUserAvatar:B,MaterialAddUser:q,MaterialNumberInput:P,MaterialTextButton:N,MaterialToast:I,MaterialButton:w},setup(){const{isDark:t}=C();return{isDark:t,joinParty:()=>{window.location.href=S("/join-party")}}},data(){return{avatars:[],newUser:"",impostorsCount:1,showSuccessToast:!1,toastMessage:"",toastType:"success",gameCode:null}},computed:{maxImpostors(){return Math.max(1,this.avatars.length-1)},isFormValid(){return this.avatars.length>=3&&this.impostorsCount>=1&&this.impostorsCount<this.avatars.length}},mounted(){this.loadFromStorage()},methods:{addNewUser(){this.newUser.trim()&&(this.avatars.push(this.newUser.trim()),this.newUser="",this.saveToStorage())},removeUser(t){this.avatars.splice(t,1),this.saveToStorage(),this.impostorsCount>=this.avatars.length&&(this.impostorsCount=Math.max(1,this.avatars.length-1))},async createParty(){if(this.isFormValid)try{const{code:t,config:e}=D(this.avatars,this.impostorsCount,`Partita del ${new Date().toLocaleDateString()}`);sessionStorage.setItem("currentParty",JSON.stringify(e)),sessionStorage.setItem("currentGameCode",JSON.stringify(t)),this.gameCode=t,this.toastMessage="Partita creata con successo!",this.toastType="success",this.showSuccessToast=!0}catch(t){this.toastMessage=`Errore: ${t.message}`,this.toastType="error",this.showSuccessToast=!0}},async copyGameCode(){try{const e=`https://ares-17.github.io/impostore/view-word.html?token=${this.gameCode}`;await navigator.clipboard.writeText(e),this.toastMessage="Codice copiato negli appunti!",this.toastType="success",this.showSuccessToast=!0}catch{this.toastMessage="Impossibile copiare il codice",this.toastType="error",this.showSuccessToast=!0}},saveToStorage(){sessionStorage.setItem("savedNicknames",JSON.stringify(this.avatars))},loadFromStorage(){try{const t=sessionStorage.getItem("savedNicknames");if(t){const e=JSON.parse(t);e.length>0&&(this.avatars=e)}}catch(t){console.error("Errore nel caricamento dei nicknames:",t)}}}},E={class:"page-container"},L={class:"avatars-grid mt-3"},R={key:0,class:"add-user-section"},H={key:0},Y={key:1,class:"create-button-section"},K={key:2,class:"game-code-section"},Q={class:"code-container"},W={class:"game-code"},X={class:"copy-button-section"},Z={key:0,class:"join-party"};function $(t,e,u,m,s,o){const p=c("MaterialUserAvatar"),h=c("MaterialAddUser"),g=c("MaterialNumberInput"),v=c("MaterialTextButton"),b=c("MaterialToast");return r(),i("div",{class:f(["create-party-page",{"dark-mode":m.isDark}])},[a("div",E,[e[8]||(e[8]=a("h1",{class:"page-title"},"Crea Nuova Partita ðŸŽ‰",-1)),e[9]||(e[9]=a("div",{class:"mt-4"},[a("span",null,[_("Vuoi iniziare una nuova partita? ðŸŽ² "),a("br"),_(" In questa pagina puoi generare un codice unico da condividere con i tuoi amici. "),a("br"),_(" Copia il codice e invialo agli altri giocatori: chiunque lo inserirÃ  potrÃ  unirsi alla tua partita.")])],-1)),a("div",null,[e[3]||(e[3]=a("h2",{class:"section-title"},"Giocatori",-1)),e[4]||(e[4]=a("span",{class:""},"Inserisci almeno 4 giocatori per procedere",-1)),a("div",L,[(r(!0),i(x,null,M(s.avatars,(l,y)=>(r(),U(p,{key:y,nickname:l,size:72,clickable:!0,deletable:!s.gameCode,onDelete:se=>o.removeUser(y)},null,8,["nickname","deletable","onDelete"]))),128))]),s.gameCode?d("",!0):(r(),i("div",R,[n(h,{modelValue:s.newUser,"onUpdate:modelValue":e[0]||(e[0]=l=>s.newUser=l),index:s.avatars.length,deletable:!1,onAddUser:o.addNewUser},null,8,["modelValue","index","onAddUser"])]))]),s.gameCode?d("",!0):(r(),i("div",H,[e[5]||(e[5]=a("h2",{class:"section-title"},"Impostori",-1)),n(g,{modelValue:s.impostorsCount,"onUpdate:modelValue":e[1]||(e[1]=l=>s.impostorsCount=l),label:"Numero di impostori",placeholder:"Inserisci numero impostori",max:o.maxImpostors,min:1,step:1},null,8,["modelValue","max"])])),s.gameCode?d("",!0):(r(),i("div",Y,[n(v,{text:"Crea Partita ðŸŽ®","color-scheme":"primary",disabled:!o.isFormValid,onClick:o.createParty},null,8,["disabled","onClick"])])),s.gameCode?(r(),i("div",K,[e[6]||(e[6]=a("h3",null,"Codice Partita",-1)),a("div",Q,[a("code",W,T(s.gameCode),1)]),a("div",X,[n(v,{text:"Copia link di accesso","color-scheme":"outline",onClick:o.copyGameCode},null,8,["onClick"])]),e[7]||(e[7]=a("p",{class:"hint"},"Condividi questo codice con i giocatori per farli unire alla partita",-1))])):d("",!0)]),s.gameCode?(r(),i("div",Z,[n(v,{text:"Accedi al party ðŸŽ®","color-scheme":"primary",disabled:!o.isFormValid,onClick:m.joinParty},null,8,["disabled","onClick"])])):d("",!0),n(b,{show:s.showSuccessToast,"onUpdate:show":e[2]||(e[2]=l=>s.showSuccessToast=l),message:s.toastMessage,type:s.toastType},null,8,["show","message","type"])],2)}const ee=k(z,[["render",$],["__scopeId","data-v-cf74843f"]]),ie=JSON.parse('{"title":"","description":"","frontmatter":{"prev":false,"next":false},"headers":[],"relativePath":"create-party.md","filePath":"create-party.md"}'),te={name:"create-party.md"},ne=Object.assign(te,{setup(t){return(e,u)=>(r(),i("div",null,[n(ee)]))}});export{ie as __pageData,ne as default};
